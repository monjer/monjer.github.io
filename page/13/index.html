<!doctype html>




<html class="theme-next muse" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>






<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="monjer's note" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta property="og:type" content="website">
<meta property="og:title" content="monjer&#39;s note">
<meta property="og:url" content="http://monjer.github.io/page/13/index.html">
<meta property="og:site_name" content="monjer&#39;s note">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="monjer&#39;s note">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: false,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://monjer.github.io/page/13/"/>





  <title>monjer's note</title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?2b4f08dbd457a5e207bff33f77b0eafc";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>











  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">monjer's note</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://monjer.github.io/2014/02/15/Tomcat下GZip文件压缩/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="monjer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="monjer's note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/02/15/Tomcat下GZip文件压缩/" itemprop="url">Tomcat下GZip文件压缩</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-02-15T00:00:00+08:00">
                2014-02-15
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/02/15/Tomcat下GZip文件压缩/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/02/15/Tomcat下GZip文件压缩/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>压缩网络传输的文件，通过减小文件大小，可以节省带宽，提高站点的响应速度，优化前端的页面展示体验。Tomcat中支持<a href="4">GZip</a>压缩。本篇以Tomcat7.0为例，介绍Tomcat如何开启<a href="4">GZip</a>功能。</p>
<h3 id="配置属性及说明"><a href="#配置属性及说明" class="headerlink" title="配置属性及说明"></a>配置属性及说明</h3><p>通过浏览器请求服务器资源，使用的是HTTP协议，Tomcat中server.xml配置文件中的HTTP Connector组件用来支持HTTP/1.1协议，负责处理所有的HTTP请求和响应，默认配置如下：</p>
<pre><code>&lt;Connector port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot;
         connectionTimeout=&quot;20000&quot;
         redirectPort=&quot;8443&quot; /&gt;
</code></pre><p> 需要在该配置上添加与Gzip相关的属性来开启<a href="4">GZip</a>压缩，配置如下：</p>
<pre><code>&lt;Connector port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot;
        connectionTimeout=&quot;20000&quot;
        redirectPort=&quot;8443&quot;
        compression=&quot;on&quot;
        compressionMinSize=&quot;2048&quot;
        compressableMimeType=&quot;text/html,text/xml,text/plain&quot;
        noCompressionUserAgents=&quot;Chrome&quot;/&gt;
</code></pre><p>新增的四个属性都是与GZip相关的配置，其中</p>
<ul>
<li><p><code>comprress</code> - 控制是否开启HTTP/1.1 Gzip压缩，设置为</p>
<ul>
<li><code>on</code>，开启GZip；</li>
<li><code>off</code>，关闭GZip；</li>
<li><code>force</code>，强制所有文件都进行压缩；</li>
<li><p><code>正整数数值</code>，等同于    设置为<code>on</code>并指定被压缩的数据量的最小阀值；</p>
<p>默认设置为<code>off</code>关闭。如果compress设置为<code>on</code>或数值，并且响应消息头中没有添加<code>content-length</code>消息头，数据同样会被压缩。</p>
</li>
</ul>
</li>
<li><p><code>compressableMimeType</code> - 指定允许压缩的文件的MIME类型，可以以<code>,</code>分隔符指定一个类型列表，默认为<code>text/html,text/xml,text/plain</code>。</p>
</li>
<li><code>noCompressionUserAgents</code> - 指定一个字符串，过滤HTTP请求中的<code>user-agent</code>消息头，忽略来自匹配的HTTP客户端的<a href="4">GZip</a>压缩请求,支持正则表达式，默认为空字符串。</li>
<li><code>compressionMinSize</code> - <code>compression</code>设置为<code>on</code>后，该属性用以指定可以被压缩的数据量的最小阀值，小于该值的数据将不会被压缩，默认为<strong>2048KB</strong>。</li>
</ul>
<h3 id="基于浏览器的示例"><a href="#基于浏览器的示例" class="headerlink" title="基于浏览器的示例"></a>基于浏览器的示例</h3><p>下面围绕这几个属性介绍几个简单的示例作为解释。本机Mac OS系统，7.0.42版本的Tomcat，使用Chrome浏览器请求页面并查看测试效果。此处省略环境的配置过程，直接跳到测试环节，通过对比来查看配置的效果。</p>
<ol>
<li><p><strong>开启GZip压缩</strong></p>
<p> 默认情况下Tomcat关闭了<a href="4">GZip</a>，我们启动Tomcat，Chrome地址栏中输入<code>http://localhost:8080</code>请求Tomcat的默认页面，并打开控制台，查看默认页面的交互情况，页面如下：</p>
 <img src="/2014/02/15/Tomcat下GZip文件压缩/1.png" alt="1.png" title="">
<p> 可以看到页面(localhost)当前的大小为<strong>11.1KB</strong>，之后开启<a href="4">GZip</a>配置，</p>
<pre><code>&lt;Connector connectionTimeout=&quot;20000&quot;
      port=&quot;8080&quot;
      protocol=&quot;HTTP/1.1&quot;
      redirectPort=&quot;8443&quot;
      compression=&quot;on&quot;
      /&gt;
</code></pre><p> 重启Tomcat再次刷新页面，查看结果，如下</p>
 <img src="/2014/02/15/Tomcat下GZip文件压缩/2.png" alt="2.png" title="">
<p> <code>localhost</code>页面被压缩到了<strong>2.2KB</strong></p>
<p> 打开<code>localhost</code>页面的请求详情</p>
 <img src="/2014/02/15/Tomcat下GZip文件压缩/6.png" alt="6.png" title="">
<p> 可以看到请求消息中的消息头</p>
<pre><code>Accept-Encoding:gzip,deflate,sdch
</code></pre><p> 响应消息的消息头</p>
<pre><code>Content-Encoding:gzip
</code></pre><p> 正式这两个消息头协调浏览器和服务器完成压缩的协商过程。</p>
</li>
<li><p><strong>添加对其它类型文件压缩的支持</strong></p>
<p> 默认情况下Tomcat的<a href="4">GZip</a>压缩配置为支持<code>text/html,text/xml,text/plain</code>三种文件的类型，下面添加<code>text/css</code>类型来支持CSS文件的压缩，如下：</p>
<pre><code>&lt;Connector connectionTimeout=&quot;20000&quot;
  port=&quot;8080&quot;
  protocol=&quot;HTTP/1.1&quot;
  redirectPort=&quot;8443&quot;
  compression=&quot;on&quot;
   compressableMimeType=&quot;text/html,text/xml,text/plain,text/css&quot;
  /&gt;
</code></pre><p> 压缩前tomcat.css的大小为<strong>5.7KB</strong>,重启Tomcat，刷新页面</p>
 <img src="/2014/02/15/Tomcat下GZip文件压缩/3.png" alt="3.png" title="">
<p> tomcat.css压缩到<strong>2.0KB</strong>。要压缩其它的文件，只要将其MIME类型字符串依次添加进去即可。</p>
</li>
<li><p><strong>屏蔽来自Chrome浏览器</strong></p>
<p> 在Chrome的控制台打开locahost页面的请求详情，查看请求<code>User-Agent</code>的字符串描述</p>
 <img src="/2014/02/15/Tomcat下GZip文件压缩/4.png" alt="4.png" title="">
<pre><code>User-Agent:Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/32.0.1700.77 Safari/537.36
</code></pre><p> 配置Tomcat，添加正则表达式<code>.*Chrome.*</code>来匹配Chrome浏览器，如下</p>
<pre><code>&lt;Connector connectionTimeout=&quot;20000&quot;
      port=&quot;8080&quot;
      protocol=&quot;HTTP/1.1&quot;
      redirectPort=&quot;8443&quot;
      compression=&quot;on&quot;
      compressableMimeType=&quot;text/html,text/xml,text/plain,text/css&quot;
      noCompressionUserAgents=&quot;.*Chrome.*&quot;
      /&gt;
</code></pre><p>  重启Tomcat，刷新页面</p>
<img src="/2014/02/15/Tomcat下GZip文件压缩/5.png" alt="5.png" title="">
<p> 可以看到页面和CSS文件都未被压缩！类似的情况我们可以根据请求消息中的<code>User-Agent</code>消息头来屏蔽来自不同的浏览器或其它类型的客户端的<a href="4">GZip</a>请求。</p>
</li>
<li><p>限定可被压缩数据的最小值</p>
<p> 设置<code>compression=&#39;on&#39;</code>之后，可以使用<code>compressionMinSize</code>属性来设置可以被压缩数据的最小值，如果HTTP的响应返回的数据或文件小于<code>compressionMinSize</code>指定的值则不会被压缩，但这有一个前提是<strong>HTTP响应中必须以<code>content-length</code>消息头返回数据的总长度</strong>，否则<code>compressionMinSize</code>设置不会起作用，返回的数据或文件照样会被Tomcat压缩。</p>
<p> 由于要控制响应中<code>content-length</code>消息的设置，我们需要一个动态的JSP页面为例进行验证。Tomcat的<code>webapps</code>目录默认安装了几个web应用，其中<code>examples</code>应用中包含了一些学习jsp/servlet的实例代码，地址栏中输入<code>http://localhost:8080/examples/jsp/index.html</code>，该页面列出了所有示例代码，我们现在拷贝<code>index.html</code>页面中的HTML代码，在同级目录下新建名为<code>demo.jsp</code>的页面并将代码拷贝到其中，该页面其实还是一个纯静态的页面，现在我们关闭<a href="4">GZip</a>压缩，请求页面来查看该文件的大小，配置如下：</p>
<pre><code>&lt;Connector connectionTimeout=&quot;20000&quot;
  port=&quot;8080&quot;
  protocol=&quot;HTTP/1.1&quot;
  redirectPort=&quot;8443&quot;
  compression=&quot;off&quot;
  /&gt;
</code></pre><p> 地址栏中输入<code>http://localhost:8080/examples/jsp/demo.jsp</code>,请求该页面：</p>
 <img src="/2014/02/15/Tomcat下GZip文件压缩/7.png" alt="7.png" title="">
<p> 可以看到页面大小为<strong>18.9KB</strong>,这是页面未经压缩的原始大小。之后我们将<code>compressionMinSize</code>限定在<strong>100KB</strong>,配置如下:</p>
<pre><code>&lt;Connector connectionTimeout=&quot;20000&quot;
      port=&quot;8080&quot;
      protocol=&quot;HTTP/1.1&quot;
      redirectPort=&quot;8443&quot;
      compression=&quot;on&quot;
      compressionMinSize=&quot;102400&quot;
      /&gt;
</code></pre><p> 如上配置，想象中，当返回数据或文件小于<strong>100KB</strong>时将不会被压缩，但实际上我们重启服务器再次请求页面查看结果便知：</p>
 <img src="/2014/02/15/Tomcat下GZip文件压缩/8.png" alt="8.png" title="">
<p> 可以看到<code>demo.jsp</code>文件被压缩到了<strong>3.4KB</strong>。下面我们在<code>demo.jsp</code>页面中加入设置<code>content-length</code>响应头的代码。</p>
<pre><code>&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot; pageEncoding=&quot;UTF-8&quot;%&gt;
&lt;%
    response.addHeader(&quot;content-length&quot;, &quot;19353&quot;);//设置大小为18.9KB
%&gt;
</code></pre><p> 再次刷新页面</p>
 <img src="/2014/02/15/Tomcat下GZip文件压缩/9.png" alt="9.png" title="">
<p> 可以看到<code>demo.jsp</code>页面没有再被压缩，<code>content-length</code>属性的设置确实发生作用。</p>
</li>
</ol>
<blockquote>
<p>注:<code>compressionMinSize</code>属性是在Tomcai7.0版本中新增的属性，Tomcat6.0中不存在该属性。</p>
</blockquote>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="1">compressionMinSize does not work on Tomcat 6</a></li>
<li><a href="2">The HTTP Connector - Tomcat6</a></li>
<li><a href="3">The HTTP Connector - Tomcat7</a></li>
<li><a href="4">GZip</a></li>
<li><a href="5">互联网媒体类型</a></li>
<li><a href="6">多用途互聯網郵件擴展</a></li>
<li><a href="7">Tomcat 7 GZIP compression not working</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://monjer.github.io/2014/01/26/MySQL用户的创建和删除/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="monjer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="monjer's note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/01/26/MySQL用户的创建和删除/" itemprop="url">MySQL用户的创建和删除</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-01-26T00:00:00+08:00">
                2014-01-26
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/01/26/MySQL用户的创建和删除/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/01/26/MySQL用户的创建和删除/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>MySQL中使用<code>create user</code>语句来创建用户，使用<code>drop user</code>语句来删除用户。创建用户时，必须拥有mysql数据库的全局<strong>CREATE USER权限</strong>或<strong>INSERT权限</strong>；删除用户时，必须拥有mysql数据库全局<strong>CREATE USER权限</strong>或<strong>DELETE权限</strong>。所有用户的记录保存在<code>mysql.user</code>表中。</p>
<p>首先以<code>root</code>身份登录MySQL,并查看当前用户记录</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">192:~ manjun.han$ mysql -uroot -pnewpass;</div><div class="line">Warning: Using a password on the <span class="built_in">command</span> line interface can be insecure.</div><div class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</div><div class="line">Your MySQL connection id is 3840</div><div class="line">Server version: 5.6.15 MySQL Community Server (GPL)</div><div class="line"></div><div class="line">Copyright (c) 2000, 2013, Oracle and/or its affiliates. All rights reserved.</div><div class="line"></div><div class="line">Oracle is a registered trademark of Oracle Corporation and/or its</div><div class="line">affiliates. Other names may be trademarks of their respective</div><div class="line">owners.</div><div class="line"></div><div class="line">Type <span class="string">'help;'</span> or <span class="string">'\h'</span> <span class="keyword">for</span> help. Type <span class="string">'\c'</span> to clear the current input statement.</div><div class="line"></div><div class="line">mysql&gt;select user,host,password from mysql.user;</div><div class="line">+------+---------------+-------------------------------------------+</div><div class="line">| user | host          | password                                  |</div><div class="line">+------+---------------+-------------------------------------------+</div><div class="line">| root | localhost     | *D8DECEC305209EEFEC43008E1D420E1AA06B19E0 |</div><div class="line">| root | 192.168.2.111 |                                           |</div><div class="line">| root | ::1           | *D8DECEC305209EEFEC43008E1D420E1AA06B19E0 |</div><div class="line">+------+---------------+-------------------------------------------+</div></pre></td></tr></table></figure>
<h3 id="添加新用户"><a href="#添加新用户" class="headerlink" title="添加新用户"></a>添加新用户</h3><p>新用户的用户名为<code>UA</code>,如</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">mysql&gt; create user UA;</div><div class="line">Query OK, 0 rows affected (0.03 sec)</div><div class="line"></div><div class="line">mysql&gt; select user,host from mysql.user;</div><div class="line">+------+---------------+-------------------------------------------+</div><div class="line">| user | host          | password                                  |</div><div class="line">+------+---------------+-------------------------------------------+</div><div class="line">| UA   | %             |                                           |</div><div class="line">| root | localhost     | *D8DECEC305209EEFEC43008E1D420E1AA06B19E0 |</div><div class="line">| root | 192.168.2.111 |                                           |</div><div class="line">| root | ::1           | *D8DECEC305209EEFEC43008E1D420E1AA06B19E0 |</div><div class="line">+------+---------------+-------------------------------------------+</div><div class="line">4 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt;</div></pre></td></tr></table></figure>
<p>默认情况下新用户的密码为空，使用<code>identified by</code>语句可以在新用户时指定初始密码，如创建用户<code>UB</code>,指定密码<code>123</code>：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">mysql&gt; create user UB identified by <span class="string">'123'</span>;</div><div class="line">Query OK, 0 rows affected (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select user,host,password from mysql.user;</div><div class="line">+------+---------------+-------------------------------------------+</div><div class="line">| user | host          | password                                  |</div><div class="line">+------+---------------+-------------------------------------------+</div><div class="line">| root | localhost     | *D8DECEC305209EEFEC43008E1D420E1AA06B19E0 |</div><div class="line">| root | 192.168.2.111 |                                           |</div><div class="line">| root | ::1           | *D8DECEC305209EEFEC43008E1D420E1AA06B19E0 |</div><div class="line">| UB   | %             | *23AE809DDACAF96AF0FD78ED04B6A265E05AA257 |</div><div class="line">| UA   | %             |                                           |</div><div class="line">+------+---------------+-------------------------------------------+</div><div class="line">5 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt;</div></pre></td></tr></table></figure>
<p>MySQL会为明文的密码自动加密，加密的算法是调用<code>PASSWORD()</code>函数完成，如果不想以明文发送密码的话，你需要知道<code>PASSWORD()</code>函数返回对应密码的混编值，之后在添加<code>password</code>关键字即可，如:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">mysql&gt; create user UC identified by password <span class="string">'*6C8989366EAF75BB670AD8EA7A7FC1176A95CEF4'</span>;</div><div class="line">Query OK, 0 rows affected (0.04 sec)</div><div class="line"></div><div class="line">mysql&gt; select user,host,password from mysql.user;</div><div class="line">+------+---------------+-------------------------------------------+</div><div class="line">| user | host          | password                                  |</div><div class="line">+------+---------------+-------------------------------------------+</div><div class="line">| root | localhost     | *D8DECEC305209EEFEC43008E1D420E1AA06B19E0 |</div><div class="line">| root | 192.168.2.111 |                                           |</div><div class="line">| UA   | %             |                                           |</div><div class="line">| root | ::1           | *D8DECEC305209EEFEC43008E1D420E1AA06B19E0 |</div><div class="line">| UC   | %             | *6C8989366EAF75BB670AD8EA7A7FC1176A95CEF4 |</div><div class="line">| UB   | %             | *23AE809DDACAF96AF0FD78ED04B6A265E05AA257 |</div><div class="line">+------+---------------+-------------------------------------------+</div><div class="line">6 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.01 sec)</div></pre></td></tr></table></figure>
<h3 id="删除用户"><a href="#删除用户" class="headerlink" title="删除用户"></a>删除用户</h3><p>使用<code>drop user</code>语句删除用户，需要指定正确的账户规则:’UA’@’%’。账户的用户和主机部分分别与<code>mysql.user</code>表中的<code>USER</code>字段和<code>HOST</code>字段向对应，中间用<code>&#39;@&#39;</code>连接，如删除<code>UA</code>账户：</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">mysql&gt; drop user <span class="string">'UA'</span>@<span class="string">'%'</span>;</div><div class="line">Query OK, 0 rows affected (0.08 sec)</div><div class="line"></div><div class="line">mysql&gt; select user,host,password from mysql.user;</div><div class="line">+------+---------------+-------------------------------------------+</div><div class="line">| user | host          | password                                  |</div><div class="line">+------+---------------+-------------------------------------------+</div><div class="line">| root | localhost     | *D8DECEC305209EEFEC43008E1D420E1AA06B19E0 |</div><div class="line">| root | 192.168.2.111 |                                           |</div><div class="line">| root | ::1           | *D8DECEC305209EEFEC43008E1D420E1AA06B19E0 |</div><div class="line">| UC   | %             | *6C8989366EAF75BB670AD8EA7A7FC1176A95CEF4 |</div><div class="line">| UB   | %             | *23AE809DDACAF96AF0FD78ED04B6A265E05AA257 |</div><div class="line">+------+---------------+-------------------------------------------+</div><div class="line">5 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.01 sec)</div><div class="line"></div><div class="line">mysql&gt;</div></pre></td></tr></table></figure>
<blockquote>
<p><code>drop user</code>删除的账户所包含的权限也会一起清除。</p>
</blockquote>
<p>也可以在一条语句中删除多个账户，账户之间要用<code>&quot;,&quot;</code>分割，如删除<code>UB</code>,’UC’:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">mysql&gt; drop user <span class="string">'UB'</span>@<span class="string">'%'</span>,<span class="string">'UC'</span>@<span class="string">'%'</span>;</div><div class="line">Query OK, 0 rows affected (0.05 sec)</div><div class="line"></div><div class="line">mysql&gt; select user,host,password from mysql.user;</div><div class="line">+------+---------------+-------------------------------------------+</div><div class="line">| user | host          | password                                  |</div><div class="line">+------+---------------+-------------------------------------------+</div><div class="line">| root | localhost     | *D8DECEC305209EEFEC43008E1D420E1AA06B19E0 |</div><div class="line">| root | 192.168.2.111 |                                           |</div><div class="line">| root | ::1           | *D8DECEC305209EEFEC43008E1D420E1AA06B19E0 |</div><div class="line">+------+---------------+-------------------------------------------+</div><div class="line">3 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt;</div></pre></td></tr></table></figure>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="http://dev.mysql.com/doc/refman/5.1/zh/sql-syntax.html#database-administration-statements" target="_blank" rel="external">MySQL5.1 数据库管理语句</a></li>
<li><a href="http://dev.mysql.com/doc/refman/5.6/en/account-management-sql.html" target="_blank" rel="external">MysQL5.6 Account Management Statements</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://monjer.github.io/2014/01/25/MySQL中auto-increment关键字的基本使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="monjer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="monjer's note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/01/25/MySQL中auto-increment关键字的基本使用/" itemprop="url">MySQL中auto_increment关键字的基本使用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-01-25T00:00:00+08:00">
                2014-01-25
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/01/25/MySQL中auto-increment关键字的基本使用/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/01/25/MySQL中auto-increment关键字的基本使用/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="auto-increment的作用"><a href="#auto-increment的作用" class="headerlink" title="auto_increment的作用"></a>auto_increment的作用</h3><p>在MySQL中`auto_increment关键字可以为表中新插入的行自动生成一个唯一标识。在开发过程中经常会设置表中主键为自増长，这是通过为主键字段添加auto_increment属性实现的，如新建一个Person表：
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mysql&gt; create table Person(id int  auto_increment, name varchar(50),primary key(id));</div><div class="line">Query OK, 0 rows affected (0.91 sec)</div></pre></td></tr></table></figure></p>
<p>之后连续插入4条记录
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">mysql&gt; insert into Person(name) value(<span class="string">'PA'</span>);</div><div class="line">Query OK, 1 row affected (0.23 sec)</div><div class="line"></div><div class="line">mysql&gt; insert into Person(name) value(<span class="string">'PB'</span>);</div><div class="line">Query OK, 1 row affected (0.05 sec)</div><div class="line"></div><div class="line">mysql&gt; insert into Person(name) value(<span class="string">'PC'</span>);</div><div class="line">Query OK, 1 row affected (0.04 sec)</div><div class="line"></div><div class="line">mysql&gt; insert into Person(name) value(<span class="string">'PD'</span>);</div><div class="line">Query OK, 1 row affected (0.00 sec)</div><div class="line">```	 	</div><div class="line"> 再将全部结果查出</div><div class="line"> ```sh</div><div class="line">mysql&gt; select * from Person;</div><div class="line">+----+------+</div><div class="line">| id | name |</div><div class="line">+----+------+</div><div class="line">|  1 | PA   |</div><div class="line">|  2 | PB   |</div><div class="line">|  3 | PC   |</div><div class="line">|  4 | PD   |</div><div class="line">+----+------+</div><div class="line">4 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.04 sec)</div><div class="line"></div><div class="line">mysql&gt; </div><div class="line">```	</div><div class="line">虽然在insert语句只能未指定id的值，但MySQL已经自动为id字段自动赋值。</div><div class="line"> 	</div><div class="line"><span class="comment">### 表中设置auto_increment的起始值</span></div><div class="line"></div><div class="line">我们可以指定表中使用`alter table`语句设置`auto_increment`的起始值，如</div><div class="line">```sh</div><div class="line">mysql&gt; alter table Person auto_increment=100;</div><div class="line">Query OK, 0 rows affected (0.41 sec)</div><div class="line">Records: 0  Duplicates: 0  Warnings: 0</div><div class="line">mysql&gt; insert into Person(name) values(<span class="string">'PE'</span>);</div><div class="line">Query OK, 1 row affected (0.05 sec)</div><div class="line"></div><div class="line">mysql&gt; select * from Person;</div><div class="line">+-----+------+</div><div class="line">| id  | name |</div><div class="line">+-----+------+</div><div class="line">|   1 | PA   |</div><div class="line">|   2 | PB   |</div><div class="line">|   3 | PC   |</div><div class="line">|   4 | PD   |</div><div class="line">| 100 | PE   |</div><div class="line">+-----+------+</div><div class="line">5 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt;</div></pre></td></tr></table></figure></p>
<p>以上语句设置<code>Person</code>表的auto_increment的起始值为100，查询新行后可以查看新行的id已设置为100。</p>
<h3 id="与auto-increment相关的MySQL系统变量"><a href="#与auto-increment相关的MySQL系统变量" class="headerlink" title="与auto_increment相关的MySQL系统变量"></a>与auto_increment相关的MySQL系统变量</h3><p>在MySQL服务器的系统变量中，<code>auto_increment_increment</code>和<code>auto_increment_offset</code>可以用来控制<code>auto_increment</code>列的设置。可以使用<code>show variables</code>语句查看这两个变量的赋值情况，如：
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">mysql&gt; show variables like <span class="string">'auto_inc%'</span>;</div><div class="line">+--------------------------+-------+</div><div class="line">| Variable_name            | Value |</div><div class="line">+--------------------------+-------+</div><div class="line">| auto_increment_increment | 1     |</div><div class="line">| auto_increment_offset    | 1     |</div><div class="line">+--------------------------+-------+</div><div class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.86 sec)</div><div class="line"></div><div class="line">mysql&gt;</div></pre></td></tr></table></figure></p>
<p><code>auto_increment_increment</code>控制<code>auto_increment</code>列的值增量，<code>auto_increment_offset</code>用于确定<code>auto_increment</code>列的值的起点值。以上查询说明<code>auto_increment</code>列的起始值为1，增量值为1.</p>
<p>通过<code>set</code>语句来为系统变量赋值，如设置<code>auto_increment</code>增量值为10，如
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">mysql&gt; <span class="built_in">set</span> auto_increment_increment=10;</div><div class="line">Query OK, 0 rows affected (0.15 sec)</div><div class="line"></div><div class="line">mysql&gt; insert into Person(name) values(<span class="string">'PF'</span>);</div><div class="line">Query OK, 1 row affected (0.96 sec)</div><div class="line"></div><div class="line">mysql&gt; insert into Person(name) values(<span class="string">'PG'</span>);</div><div class="line">Query OK, 1 row affected (0.96 sec)</div><div class="line"></div><div class="line">mysql&gt; select * from Person;</div><div class="line">+-----+------+</div><div class="line">| id  | name |</div><div class="line">+-----+------+</div><div class="line">|   1 | PA   |</div><div class="line">|   2 | PB   |</div><div class="line">|   3 | PC   |</div><div class="line">|   4 | PD   |</div><div class="line">| 100 | PE   |</div><div class="line">| 101 | PF   |</div><div class="line">| 111 | PG   |</div><div class="line">+-----+------+</div><div class="line">7 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt;</div></pre></td></tr></table></figure></p>
<p>设置<code>auto_increment</code>列的起始值为5,创建新表<code>TestAutoInc</code>,并插入两条字段，如
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">mysql&gt; <span class="built_in">set</span> auto_increment_offset=5;</div><div class="line">Query OK, 0 rows affected (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; show variables like <span class="string">'auto_inc%'</span>;</div><div class="line">+--------------------------+-------+</div><div class="line">| Variable_name            | Value |</div><div class="line">+--------------------------+-------+</div><div class="line">| auto_increment_increment | 10    |</div><div class="line">| auto_increment_offset    | 5     |</div><div class="line">+--------------------------+-------+</div><div class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.02 sec)</div><div class="line"></div><div class="line">mysql&gt; create table TestAutoInc(id int auto_increment primary key,val varchar(20));</div><div class="line">Query OK, 0 rows affected (0.18 sec)</div><div class="line"></div><div class="line">mysql&gt; insert into TestAutoInc(val) values(<span class="string">'V1'</span>);</div><div class="line">Query OK, 1 row affected (0.06 sec)</div><div class="line"></div><div class="line">mysql&gt; insert into TestAutoInc(val) values(<span class="string">'V2'</span>);</div><div class="line">Query OK, 1 row affected (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt; select * from TestAutoInc;</div><div class="line">+----+------+</div><div class="line">| id | val  |</div><div class="line">+----+------+</div><div class="line">|  5 | V1   |</div><div class="line">| 15 | V2   |</div><div class="line">+----+------+</div><div class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt;</div></pre></td></tr></table></figure></p>
<p>可以看到相邻两调记录的id相差为<code>auto_increment_offset</code>的值。</p>
<p>以下几点注意事项：</p>
<ul>
<li><p>两个变量均可以设置为全局和局部变量，默认为局部变量，修改影响的范围紧限于当前session。可在<code>set</code>关键字后添加<code>global</code>和<code>session</code>关键字来区分是全局变量更改还是局部变量更改，如</p>
<pre><code>#全局设置
mysql&gt; set global auto_increment_offset=5;
#局部设置
mysql&gt; set session auto_increment_offset=5;
</code></pre><p>  全局修改会影响所有数据库的表。</p>
</li>
<li><p>两个变量的取值范围为1到65535之间的整数，为其中某个变量赋值为0会导致该变量值为1，赋小于0或大于65535的值会导致该变量为65535.如果赋值为非整数值，则会报错。</p>
</li>
<li>如果<code>auto_increment_offset</code>的值大于<code>auto_increment_increment</code>的值，则<code>auto_increment_offset</code>的值被忽略。</li>
</ul>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="http://dev.mysql.com/doc/refman/5.6/en/replication-options-master.html#sysvar_auto_increment_increment" target="_blank" rel="external">MySQL5.6 auto_increment_increment</a></li>
<li><a href="http://dev.mysql.com/doc/refman/5.1/zh/language-structure.html#system-variables" target="_blank" rel="external">MySQL 5.1 系统变量</a></li>
<li><a href="http://dev.mysql.com/doc/refman/5.1/zh/tutorial.html#example-auto-increment" target="_blank" rel="external">MySQL 5.1 使用AUTO_INCREMENT</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://monjer.github.io/2014/01/23/mailto链接在HTML页面中的使用介绍/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="monjer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="monjer's note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/01/23/mailto链接在HTML页面中的使用介绍/" itemprop="url">mailto链接在HTML页面中的使用介绍</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-01-23T00:00:00+08:00">
                2014-01-23
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/01/23/mailto链接在HTML页面中的使用介绍/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/01/23/mailto链接在HTML页面中的使用介绍/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="什么是mailto链接"><a href="#什么是mailto链接" class="headerlink" title="什么是mailto链接"></a>什么是mailto链接</h3><p>mailto链接是HTML页面链接的一种，在HTML页面中通过点击一个mailto链接，可以打开用户计算机中默认的mail客户端程序，用网站中指定邮件地址发送邮件。网页中的mailto链接使用的是<a href="http://www.ietf.org/rfc/rfc6068.txt" target="_blank" rel="external">mailto协议</a>，该协议注册于IANA，定义了<a href="http://en.wikipedia.org/wiki/Simple_Mail_Transfer_Protocol" target="_blank" rel="external">SMTP</a>邮件地址的协议格式。</p>
<p>HTML页面中的mailto链接依赖于用户计算机中提前安装的邮件客户端，比如Window系统下的Outlook，或Mac OS X下的邮件应用</p>
<h3 id="HTML中使用mailto链接"><a href="#HTML中使用mailto链接" class="headerlink" title="HTML中使用mailto链接"></a>HTML中使用mailto链接</h3><p>可以使用HTML的<code>&lt;a&gt;</code>标签的<code>href</code>属性创建mailto链接，如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"mailto:hmj030986@gmail.com"</span>&gt;</span>联系我<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div></pre></td></tr></table></figure>
<p>产生链接:<a href="mailto:hmj030986@gmail.com" target="_blank" rel="external">联系我</a></p>
<h3 id="发送邮件并添加主题-subject-和文本消息-body"><a href="#发送邮件并添加主题-subject-和文本消息-body" class="headerlink" title="发送邮件并添加主题(subject)和文本消息(body)"></a>发送邮件并添加主题(subject)和文本消息(body)</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"mailto:hmj030986@gmail.com?subject=主题名称&amp;body=这是消息的内容"</span>&gt;</span>联系我<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div></pre></td></tr></table></figure>
<p>产生链接:<a href="mailto:hmj030986@gmail.com?subject=主题名称&body=这是消息的文本内容" target="_blank" rel="external">联系我</a></p>
<p>由于mailto协议也属于URL协议范围内的一种，URL协议规定中有许多保留的特殊字符，如果这些特殊字符出现在内容体内时，需要使用<code>%</code>形式进行<a href="http://en.wikipedia.org/wiki/Percent-encoding" target="_blank" rel="external">转码</a>。如空格使用<code>%20</code>代替,换行符用<code>%0D%0A</code>代替。如下</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"mailto:hmj030986@gmail.com?subject=主题%20名称&amp;body=这是消息的内容%0D%0A另一行内容"</span>&gt;</span>联系我<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div></pre></td></tr></table></figure>
<p>产生链接:<a href="mailto:hmj030986@gmail.com?subject=主题%20名称&body=这是消息的内容%0D%0A另一行内容" target="_blank" rel="external">联系我</a></p>
<p>同时需要注意的是<code>body</code>的值只能是普通文本(text/plain)，不能包含HTML格式(MIME)的内容,<a href="4">RFC-2368</a>英文释义</p>
<blockquote>
<p>The special hname “body” indicates that the associated hvalue is the
   body of the message. The “body” hname should contain the content for
   the first text/plain body part of the message. The mailto URL is
   primarily intended for generation of short text messages that are
   actually the content of automatic processing (such as “subscribe”
   messages for mailing lists), not general MIME bodies.</p>
</blockquote>
<h3 id="忽略收件人地址"><a href="#忽略收件人地址" class="headerlink" title="忽略收件人地址"></a>忽略收件人地址</h3><p>如</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"mailto:?subject=主题&amp;body=http://en.wikipedia.org/wiki/Mailto"</span>&gt;</span>发送消息<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div></pre></td></tr></table></figure>
<p>产生链接:<a href="mailto:?subject=主题&body=http://en.wikipedia.org/wiki/Mailto" target="_blank" rel="external">发送消息</a></p>
<h3 id="指定多个收件人地址-地址间用-quot-quot-分割"><a href="#指定多个收件人地址-地址间用-quot-quot-分割" class="headerlink" title="指定多个收件人地址,地址间用&quot;,&quot;分割"></a>指定多个收件人地址,地址间用<code>&quot;,&quot;</code>分割</h3><p>如</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"mailto:hmj030986@gmail.com,someone@gmail.com"</span>&gt;</span>联系我们<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div></pre></td></tr></table></figure>
<p>产生链接:<a href="mailto:hmj030986@gmail.com,someone@gmail.com" target="_blank" rel="external">联系我们</a></p>
<h3 id="添加抄送地址-Cc-和密送地址-Bcc"><a href="#添加抄送地址-Cc-和密送地址-Bcc" class="headerlink" title="添加抄送地址(Cc)和密送地址(Bcc)"></a>添加抄送地址(Cc)和密送地址(Bcc)</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"mailto:hmj030986@gmail.com?cc=cc1@gmail.com,cc2@gmail.com&amp;bcc=bcc1@gmail.com,bcc2@gmail.com&amp;subject=主题内容"</span>&gt;</span>联系我们<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div></pre></td></tr></table></figure>
<p>产生链接:<a href="mailto:hmj030986@gmail.com?cc=cc1@gmail.com,cc2@gmail.com&bcc=bcc1@gmail.com,bcc2@gmail.com&subject=主题内容" target="_blank" rel="external">联系我们</a></p>
<p>以上也是可以使用<code>&quot;,&quot;</code>分割多个邮件地址。</p>
<h3 id="参数整理"><a href="#参数整理" class="headerlink" title="参数整理"></a>参数整理</h3><table>
            <tbody><tr>
                <th width="215">参数</th>
                <th>说明</th>
            </tr>
            <tr>
                <td width="207">mailto:<i>address@email.com</i></td>
                <td>收件人邮箱地址</td>
            </tr>
            <tr>
                <td width="207">cc=<i>address@email.com</i></td>
                <td>抄送人邮箱地址</td>
            </tr>
            <tr>
                <td width="207">bcc=<i>address@email.com</i></td>
                <td>密送人邮箱地址</td>
            </tr>
            <tr>
                <td width="207">subject=<i>名称</i></td>
                <td>邮件主题名</td>
            </tr>
            <tr>
                <td width="207">body=<i>内容</i></td>
                <td>邮件文本消息</td>
            </tr>
            <tr>
                <td width="207">?</td>
                <td>第一个参数的分隔符</td>
            </tr>
            <tr>
                <td width="207">&amp;</td>
                <td>剩余参数分隔符</td>
            </tr>
        </tbody>
    </table>

<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="http://www.ietf.org/rfc/rfc6068.txt" target="_blank" rel="external">RFC-6068</a></li>
<li><a href="http://css-tricks.com/snippets/html/mailto-links/" target="_blank" rel="external">Mailto Links</a></li>
<li><a href="http://en.wikipedia.org/wiki/Mailto" target="_blank" rel="external">Wiki mailto</a></li>
<li><a href="http://stackoverflow.com/questions/5620324/mailto-with-html-body" target="_blank" rel="external">MailTo with HTML body</a></li>
<li><a href="http://www.rapidtables.com/web/html/mailto.htm" target="_blank" rel="external">mailto: HTML e-mail link</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://monjer.github.io/2014/01/21/AS3使用Capabilities类获取Flash-Player的信息/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="monjer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="monjer's note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/01/21/AS3使用Capabilities类获取Flash-Player的信息/" itemprop="url">AS3使用Capabilities类获取Flash Player的信息</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-01-21T00:00:00+08:00">
                2014-01-21
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/01/21/AS3使用Capabilities类获取Flash-Player的信息/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/01/21/AS3使用Capabilities类获取Flash-Player的信息/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>AS3中<code>flash.system.Capabilities</code>类提供诸多静态的只读属性来描述应用程序当前所运行在的系统和运行时信息，如Flash Player,Adobe AIR,Flash Lite。通过<code>Capabilities</code>可以确定运行应用程序的客户端的诸多信息，并依此来为用户提供程序本身定制化的内容。本篇只就获取浏览器中嵌入的<a href="http://www.adobe.com/cn/products/flashplayer.html" target="_blank" rel="external">Flash Player</a>运行时，来列举一些获取其几个常见信息所涉及到的属性和释义。</p>
<h3 id="运行时类型"><a href="#运行时类型" class="headerlink" title="运行时类型"></a>运行时类型</h3><p><code>Capabilities.playerType</code>属性描述了当前应用程序的运行时类型。</p>
<p>可以是以下几种类型：</p>
<ul>
<li><p><code>&quot;ActiveX&quot;</code></p>
<p>  用于 Microsoft Internet Explorer 使用的 Flash Player ActiveX 控件</p>
</li>
<li><p><code>“Desktop”</code></p>
<p>  代表 Adobe AIR 运行时（通过 HTML 页加载的 SWF 内容除外，该内容将 Capabilities.playerType 设置为“PlugIn”）</p>
</li>
<li><p><code>“External”</code></p>
<p>  用于外部 Flash Player 或处于测试模式下</p>
</li>
<li><p><code>“PlugIn”</code></p>
<p>  代表 Flash Player 浏览器插件（和通过 AIR 应用程序中的 HTML 页加载的 SWF 内容）</p>
</li>
<li><p><code>&quot;StandAlone&quot;</code></p>
<p>  用于独立的 Flash Player</p>
</li>
</ul>
<p>在以插件形式嵌入到浏览器中的Flash Player运行时上，<code>Capablities.playerType</code>返回的<code>&quot;PlugIn&quot;</code>。如，</p>
<pre><code>var playerType:String = Capablities.playerType ;
trace(&quot;playerType : &quot;+playerType); // playerType : Plugin
</code></pre><h3 id="运行时是否是调试版"><a href="#运行时是否是调试版" class="headerlink" title="运行时是否是调试版"></a>运行时是否是调试版</h3><p><code>Capabilities.isDebugger</code>属性描述运行时是否为调试版本。<code>ture</code>说明当前运行时是否是调试版，<code>false</code>说明当前运行时为正式版。如</p>
<pre><code>var isDebuggerVersion:Boolean = Capabilities.isDebugger;
trace(&quot;Debugger Version : &quot;+isDebuggerVersion); // Debugger Version : true
</code></pre><p>Adobe的运行时包括两种类型，正式发布版(release version)和调试版(debug version)，对于开发人员来说，为了在开发过程便于程序调试，我们往往使用的是调试版的的运行时版本。对于普通的用户来说，他们使用的大多是正式发行版，对于Flash Player可以去Adobe Flash Support Center来查看最新版的FLash Player<a href="http://www.adobe.com/support/flashplayer/downloads.html" target="_blank" rel="external">下载</a>信息。</p>
<h3 id="操作系统类型"><a href="#操作系统类型" class="headerlink" title="操作系统类型"></a>操作系统类型</h3><p><code>Capabilities.os</code>属性指定了当期操作系统的名称，常见的系统和对应值有</p>
<table>
  <tbody>
    <tr>
      <th>操作系统</th>
      <th>值</th>
    </tr>
    <tr>
      <td>Windows 8</td>
      <td>
        <code>“Windows 8”</code>
      </td>
    </tr>
    <tr>
      <td>Windows 7</td>
      <td>
        <code>“Windows 7”</code>
      </td>
    </tr>
    <tr>
      <td>Windows Server 2003</td>
      <td>
        <code>“Windows Server 2003”</code>
      </td>
    </tr>
    <tr>
      <td>Windows XP 64</td>
      <td>
        <code>“Windows Server XP 64”</code>
      </td>
    </tr>
    <tr>
      <td>Windows XP</td>
      <td>
        <code>“Windows XP”</code>
      </td>
    </tr>
    <tr>
      <td>Windows Mobile</td>
      <td>
        <code>“Windows Mobile”</code>
      </td>
    </tr>
    <tr>
      <td>Mac OS</td>
      <td>
        <code>“Mac OS X.Y.Z”</code>（其中 X.Y.Z 为版本号，例如 
        <code>“Mac OS 10.5.2”</code>）
      </td>
    </tr>
    <tr>
      <td>Linux</td>
      <td>
        <code>“Linux”</code>（Flash Player 连接 Linux 版本，如 
        <code>“Linux 2.6.15-1.2054_FC5smp”</code>
      </td>
    </tr>
    <tr>
      <td>iPhone OS 4.1</td>
      <td>
        <code>“iPhone3,1”</code>
      </td>
    </tr>
  </tbody>
</table>

<p>如，
<figure class="highlight as"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> os:String = Capabilities.os;</div><div class="line">trace(<span class="string">"Current OS : "</span>+os); <span class="comment">// Current OS : Mac OS 10.8.5</span></div></pre></td></tr></table></figure></p>
<h3 id="系统语言"><a href="#系统语言" class="headerlink" title="系统语言"></a>系统语言</h3><p><code>Capabilities.language</code>属性说明，当前运行时所在系统的<a href="http://zh.wikipedia.org/wiki/%E8%AA%9E%E8%A8%80%E4%BB%A3%E7%A2%BC" target="_blank" rel="external">语言代码</a>。</p>
<p><a href="http://zh.wikipedia.org/wiki/%E8%AA%9E%E8%A8%80%E4%BB%A3%E7%A2%BC" target="_blank" rel="external">语言代码</a>是指由英文和数字组成的，用来描述语言类型的短字符串。<strong>语言</strong>指定为<a href="http://zh.wikipedia.org/wiki/ISO_639-1%E4%BB%A3%E7%A0%81%E8%A1%A8" target="_blank" rel="external">ISO 639-1</a>中小写双字母语言代码，如中文<code>zh</code>,对于中文，使用<a href="http://zh.wikipedia.org/wiki/ISO_3166-1" target="_blank" rel="external">ISO 3166</a>中的大写双字母国家/地区代码，以区分简体中文(zh-CN)和繁体中文(zh-TW) 。</p>
<p>英文系统上，此属性返回语言代码，而不返回国家/地区编码。如，
<figure class="highlight as"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> language:String = Capabilities.language;</div><div class="line">trace(<span class="string">"System language : "</span>+language); <span class="comment">// System language : zh_CN</span></div></pre></td></tr></table></figure></p>
<h3 id="版本信息"><a href="#版本信息" class="headerlink" title="版本信息"></a>版本信息</h3><p><code>Capabilities.version</code>属性描述当前运行时的版本信息。</p>
<p>版本号的格式为：平台(platform),主版本号(majorVersion),次版本号(minorVersion),生成版本号(buildNumber)，内部生成版本号(internalBuildNumber)。其中platform的可选值为<code>&quot;WIN&quot;</code>,<code>&quot;MAC&quot;</code>,<code>&quot;LNX&quot;</code>,<code>&quot;AND&quot;</code>，如</p>
<pre><code class="as"><span class="keyword">var</span> versionReg:RegExp = /^(\w*) (\d*),(\d*),(\d*),(\d*)$/;

<span class="keyword">var</span> version:String = Capabilities.version ;
trace(<span class="string">"version : "</span>+version);        <span class="comment">//version : MAC 11,9,900,170</span>
<span class="keyword">var</span> v:Object = versionReg.exec(version) ;

<span class="keyword">var</span>    platform:String = v[<span class="number">1</span>] ,
    majorVersion:String = v[<span class="number">2</span>] ,
    minorVersion:String = v[<span class="number">3</span>] ,
    buildNumber:String = v[<span class="number">4</span>] ,
    internalBuildNumber:String = v[<span class="number">5</span>];

trace(<span class="string">"platform : "</span>+platform);               <span class="comment">//platform: MAC</span>
trace(<span class="string">"majorVersion : "</span>+platform);           <span class="comment">//majorVersion: 11</span>
trace(<span class="string">"minorVersion : "</span>+platform);           <span class="comment">//minorVersion: 9</span>
trace(<span class="string">"buildNumber : "</span>+platform);           <span class="comment">//buildNumber: 900</span>
trace(<span class="string">"internalBuildNumber : "</span>+platform);   <span class="comment">//internalBuildNumber: 170</span>
</code></pre>
<p> <code>Capabilities</code>类中还包含了许多其他的描述性静态属性，详情见其<a href="http://help.adobe.com/zh_CN/FlashPlatform/reference/actionscript/3/flash/system/Capabilities.html" target="_blank" rel="external">文档</a>。</p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="http://help.adobe.com/zh_CN/as3/dev/WS5b3ccc516d4fbf351e63e3d118a9b90204-7cd8.html" target="_blank" rel="external">使用 Capabilities 类</a></li>
<li><a href="http://www.negush.net/blog/get-flash-player-version-with-as3/" target="_blank" rel="external">Get Flash player version with AS3</a></li>
<li><a href="http://help.adobe.com/en_US/flex/using/WS2db454920e96a9e51e63e3d11c0bf69084-7ebb.html" target="_blank" rel="external">Determining Flash Player version in Flex</a></li>
<li><a href="http://www.adobe.com/support/documentation/cn/flashplayer/releasenotes.html" target="_blank" rel="external">Flash Player 发行说明</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://monjer.github.io/2014/01/20/Mac-OS-X下初始化MySQL账户安全/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="monjer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="monjer's note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/01/20/Mac-OS-X下初始化MySQL账户安全/" itemprop="url">Mac OS X下初始化MySQL账户安全</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-01-20T00:00:00+08:00">
                2014-01-20
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/01/20/Mac-OS-X下初始化MySQL账户安全/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/01/20/Mac-OS-X下初始化MySQL账户安全/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在Mac OS X这样的Unix系统中，MySQL安装完成后，应该运行<strong>mysql_install_db</strong>脚本程序，设置和初始化授权表，。授权表中定义了MySQL用户账户和访问权限，以便用户连接MySQL服务器。该脚本会创建数据目录、拥有所有数据库权限的<code>mysql</code>数据库，以及用来测试MySQL的<code>test</code>数据库。MySQL为Mac OS X提供了pkg分发版来进行安装，安装器会自动运行<strong>mysql_install_db</strong>脚本。本篇基于MySQL5.6版本进行描述。</p>
<blockquote>
<p>MySQL 5.1版本与MySQL5.5之后创建的默认账户有差别</p>
</blockquote>
<p><code>mysql</code>数据库中创建了<code>user</code>、<code>db</code>、<code>host</code>、 <code>tables_priv</code>、<code>columns_priv</code>和<code>func</code>表以及其它的表，其中<code>uesr</code>表中包含了MySQL的默认账户信息和权限信息。创建默认账户的过程和设置如下：</p>
<ul>
<li>以用户名<code>root</code>创建<strong>四个</strong>账户，设置如下：<ul>
<li>账户为超级账户，可执行任何操作；</li>
<li><code>root</code>账户的初始密码为空,任何人可以在无密码的情况下使用<code>root</code>账户链接MySQL服务器，并且获得所有权限。</li>
<li>在Unix中<code>root</code>账户只能从本机进行连接，四个账户的Host主机名分别为,<code>localhost</code>,<code>127.0.0.1</code>,<code>本机实际主机名或IP地址</code>,和名为<code>::1</code>的IPV6地址</li>
</ul>
</li>
</ul>
<blockquote>
<p>使用<code>127.0.0.1</code>的host值的连接MySQL服务器，会首先转换为<code>localhost</code>对应的账户，使用<code>127.0.0.1</code>的host值,对于连接设置<code>--skip-name-resolve</code>选项的MySQL服务器会有用。</p>
</blockquote>
<ul>
<li>创建两个<code>匿名账户</code>,设置如下:<ul>
<li>每个账户的用户名都为空</li>
<li>匿名账户未设置密码，任何人可以使用<code>匿名账户</code>连接MySQL服务器</li>
<li>在Unix中，两个匿名账户均只能从本机连接MySQL服务器</li>
<li>两个匿名账户具有对<code>test</code>数据库或其它以<code>test_</code>命名开头的数据库所有权限</li>
</ul>
</li>
</ul>
<p>以上创建的账户初始时均为设置密码，匿名用户可以直接使用mysql连接MySQL，如下操作：
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">shell&gt; mysql</div><div class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</div><div class="line">Your MySQL connection id is 38</div><div class="line">Server version: 5.6.15 MySQL Community Server (GPL)</div><div class="line"></div><div class="line">Copyright (c) 2000, 2013, Oracle and/or its affiliates. All rights reserved.</div><div class="line"></div><div class="line">Oracle is a registered trademark of Oracle Corporation and/or its</div><div class="line">affiliates. Other names may be trademarks of their respective</div><div class="line">owners.</div><div class="line"></div><div class="line">Type <span class="string">'help;'</span> or <span class="string">'\h'</span> <span class="keyword">for</span> help. Type <span class="string">'\c'</span> to clear the current input statement.</div><div class="line"></div><div class="line">mysql&gt;</div></pre></td></tr></table></figure></p>
<p>使用<code>root</code>账户连接MySQL服务器，如下：
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">shell&gt; mysql -u root</div><div class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</div><div class="line">Your MySQL connection id is 148</div><div class="line">Server version: 5.6.15 MySQL Community Server (GPL)</div><div class="line"></div><div class="line">Copyright (c) 2000, 2013, Oracle and/or its affiliates. All rights reserved.</div><div class="line"></div><div class="line">Oracle is a registered trademark of Oracle Corporation and/or its</div><div class="line">affiliates. Other names may be trademarks of their respective</div><div class="line">owners.</div><div class="line"></div><div class="line">Type <span class="string">'help;'</span> or <span class="string">'\h'</span> <span class="keyword">for</span> help. Type <span class="string">'\c'</span> to clear the current input statement.</div><div class="line"></div><div class="line">mysql&gt;</div></pre></td></tr></table></figure></p>
<p>使用<code>root</code>账户连接MySQL服务器之后，可以查看创建的默认账户，如
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select host,user,password from mysql.user;</div><div class="line">+---------------+------+----------+</div><div class="line">| host          | user | password |</div><div class="line">+---------------+------+----------+</div><div class="line">| localhost     | root |          |</div><div class="line">| 192.168.2.111 | root |          |</div><div class="line">| 127.0.0.1     | root |          |</div><div class="line">| ::1           | root |          |</div><div class="line">| localhost     |      |          |</div><div class="line">| 192.168.2.111 |      |          |</div><div class="line">+---------------+------+----------+</div><div class="line">6 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt;</div></pre></td></tr></table></figure></p>
<p><code>user</code>表中的<code>host</code>字段决定了可以连接MySQL服务器的主机，<code>user</code>和<code>password</code>字段决定了连接MySQL使用的用户名和密码。只有在同时满足条件时，用户才可以连接到MySQL。从上述查询我们可以看出，默认使用了本机IP<code>192.168.2.111</code>分别创建了一个<code>root</code>(表的第2列)和一个匿名账户（表的最后一列），所有的账户都的密码都为空，意味着任何人都可以任意连接MySQL。</p>
<p>查询<code>db</code>表，执行以下语句
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">mysql&gt; select host,db,user from mysql.db;</div><div class="line">+------+---------+------+</div><div class="line">| host | db      | user |</div><div class="line">+------+---------+------+</div><div class="line">| %    | <span class="built_in">test</span>    |      |</div><div class="line">| %    | <span class="built_in">test</span>\_% |      |</div><div class="line">+------+---------+------+</div><div class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</div><div class="line">mysql&gt;</div></pre></td></tr></table></figure></p>
<p>以上显示，任何账户都可以访问<code>test</code>数据库和其它名称以<code>test_</code>开始的数据库，及时是默认创建的匿名账户。对于测试来说，直接使用<code>test</code>数据库还是很方便的，但在实际的生产环境中最好为<code>test</code>或<code>test_</code>开头的数据库设置密码，或直接将其删除。</p>
<p>所以为了保证安全，可以选择进行如下操作：</p>
<ol>
<li><p>为MySQL的每个<code>root</code>账户设置密码，可选三种操作方式设置密码，以下以<strong>newpwd</strong>指代自定义的新的密码，注意密码需要使用<code>PASSWORD()</code>函数进行加密操作。</p>
<ul>
<li><p>使用<code>SET PASSWORD</code>语句，格式为<code>SET PASSWORD FOR user=PASSWORD(&#39;new pass&#39;)</code>,其中<code>user</code>的格式为<code>user_name@host_name</code>,<code>user_name</code>和<code>host_name</code>分别匹配对应<code>mysql.user</code>表中的<code>User字段值</code>和<code>Host字段值</code>，如：</p>
<pre><code><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">mysql&gt; SET PASSWORD FOR <span class="string">'root'</span>@<span class="string">'localhost'</span> = PASSWORD(<span class="string">'newpwd'</span>);</div><div class="line">Query OK, 0 rows affected (0.09 sec)</div><div class="line"></div><div class="line">mysql&gt; SET PASSWORD FOR <span class="string">'root'</span>@<span class="string">'192.168.2.111'</span> = PASSWORD(<span class="string">'newpwd'</span>);</div><div class="line">Query OK, 0 rows affected (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt;</div></pre></td></tr></table></figure>
</code></pre></li>
<li><p>使用<code>UPDATE</code>语句，以下使用<code>UPDATE</code>语句同时为<code>root</code>账户指定相同的密码</p>
<pre><code><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">mysql&gt;  UPDATE mysql.user SET password=PASSWORD(<span class="string">'newpass'</span>) WHERE user=<span class="string">'root'</span>;</div><div class="line">Query OK, 4 rows affected (0.01 sec)</div><div class="line">Rows matched: 4  Changed: 4  Warnings: 0</div><div class="line"></div><div class="line">mysql&gt; FLUSH PRIVILEGES;</div><div class="line">Query OK, 0 rows affected (0.05 sec)</div><div class="line"></div><div class="line">mysql&gt;</div></pre></td></tr></table></figure>
</code></pre><p>  <code>FLUSH</code>语句会令MYSQL服务器重新读加载取授权表，否则，密码修改只有在MySQL下次重启后才能生效。</p>
</li>
<li><p>使用<strong>mysqladmin</strong>命令行客户端程序</p>
<p>更改<code>&#39;localhost&#39;@&#39;root&#39;</code>的账户</p>
<pre><code><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">shell&gt; <span class="built_in">cd</span> /usr/<span class="built_in">local</span>/mysql/bin</div><div class="line">shell&gt; sudo ./mysqladmin -u root password newpass</div></pre></td></tr></table></figure>
</code></pre><p>更改<code>&#39;host_name&#39;@&#39;=root&#39;</code>的账户</p>
<pre><code><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">		shell&gt; <span class="built_in">cd</span> /usr/<span class="built_in">local</span>/mysql/bin</div><div class="line">shell&gt; sudo ./mysqladmin -h host_name -u root password newpass</div></pre></td></tr></table></figure>
</code></pre><p>对于<code>host_name</code>为ip地址的形式，以及<code>&#39;root&#39;@&#39;127.0.0.1&#39;</code>和<code>&#39;root&#39;@&#39;::1&#39;</code>的账户，<strong>mysqladmin</strong>命令则无法使用，需要使用以上两种方式之一。</p>
</li>
</ul>
</li>
<li><p>为匿名账户设置密码，首先用root账户连接MySQL服务器</p>
<p> 1.使用<code>update</code>语句</p>
<pre><code><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">shell&gt; mysql -u root -pnewpass</div><div class="line">mysql&gt; update mysql.user SET password=PASSWORD(<span class="string">'newpass'</span>) <span class="built_in">where</span> user=<span class="string">''</span>;</div><div class="line">Query OK, 2 rows affected (0.07 sec)</div><div class="line">Rows matched: 2  Changed: 2  Warnings: 0</div><div class="line"></div><div class="line">mysql&gt; FLUSH PRIVILEGES;</div><div class="line">Query OK, 0 rows affected (0.05 sec)</div><div class="line"></div><div class="line">mysql&gt;</div></pre></td></tr></table></figure>
</code></pre><p> 2.使用<code>SET PASSWORD</code>语句</p>
<pre><code><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">shell&gt; mysql -u root -pnewpass</div><div class="line">mysql&gt; SET PASSWORD FOR <span class="string">''</span>@<span class="string">'localhost'</span> = PASSWORD(<span class="string">'newpwd'</span>);</div><div class="line">mysql&gt; SET PASSWORD FOR <span class="string">''</span>@<span class="string">'host_name'</span> = PASSWORD(<span class="string">'newpwd'</span>);</div></pre></td></tr></table></figure>
</code></pre></li>
<li><p>删除匿名账户</p>
<p> 使用<code>DROP USER</code>语句</p>
<pre><code><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">shell&gt; mysql -u root -pnewpass</div><div class="line">Warning: Using a password on the <span class="built_in">command</span> line interface can be insecure.</div><div class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</div><div class="line">Your MySQL connection id is 1674</div><div class="line">Server version: 5.6.15 MySQL Community Server (GPL)</div><div class="line"></div><div class="line">Copyright (c) 2000, 2013, Oracle and/or its affiliates. All rights reserved.</div><div class="line"></div><div class="line">Oracle is a registered trademark of Oracle Corporation and/or its</div><div class="line">affiliates. Other names may be trademarks of their respective</div><div class="line">owners.</div><div class="line"></div><div class="line">Type <span class="string">'help;'</span> or <span class="string">'\h'</span> <span class="keyword">for</span> help. Type <span class="string">'\c'</span> to clear the current input statement.</div><div class="line">mysql&gt; DROP USER <span class="string">''</span>@<span class="string">'localhost'</span>;</div><div class="line">Query OK, 0 rows affected (0.07 sec)</div><div class="line"></div><div class="line">mysql&gt; DROP USER <span class="string">''</span>@<span class="string">'192.168.2.111'</span>;</div><div class="line">Query OK, 0 rows affected (0.00 sec)</div><div class="line"></div><div class="line">mysql&gt;</div></pre></td></tr></table></figure>
</code></pre><p> 或使用<code>DELETE</code>语句</p>
<pre><code><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mysql&gt; delete from mysql.user <span class="built_in">where</span> user=<span class="string">''</span>;</div><div class="line">mysql&gt; flush privileges;</div></pre></td></tr></table></figure>
</code></pre></li>
<li><p><code>test</code>数据库处理</p>
<p> 方式一.禁用非全局权限账户访问<code>test</code>数据库或<code>test_</code>起始命名的数据库的权限</p>
<pre><code><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql&gt; delete from mysql.db <span class="built_in">where</span> db like <span class="string">'test%'</span>;</div></pre></td></tr></table></figure>
</code></pre><p> 方式二.直接删除</p>
<pre><code><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mysql&gt; drop database <span class="built_in">test</span>;</div></pre></td></tr></table></figure>
</code></pre></li>
</ol>
<p>参考</p>
<ul>
<li><a href="http://dev.mysql.com/doc/refman/5.7/en/default-privileges.html" target="_blank" rel="external">Securing the Initial MySQL Accounts</a></li>
<li><a href="http://dev.mysql.com/doc/refman/5.1/zh/sql-syntax.html#set-password" target="_blank" rel="external">SET PASSWORD语法</a></li>
<li><a href="http://dev.mysql.com/doc/refman/5.1/zh/database-administration.html#privilege-changes" target="_blank" rel="external">权限更改何时生效</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://monjer.github.io/2014/01/20/Mac-OS-X下命令行方式启动与关闭MySQL服务器/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="monjer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="monjer's note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/01/20/Mac-OS-X下命令行方式启动与关闭MySQL服务器/" itemprop="url">Mac OS X下命令行方式启动与关闭MySQL服务器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-01-20T00:00:00+08:00">
                2014-01-20
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/01/20/Mac-OS-X下命令行方式启动与关闭MySQL服务器/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/01/20/Mac-OS-X下命令行方式启动与关闭MySQL服务器/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Mac OS X10.2及以上版本的系统使用二进制安装软件包pkg格式来发布MySQL，安装软件在包含于下载的磁盘镜像文件中(.dmg文件)，关于Mac OS X下MySQL的安装过程，参见。本篇记录在终端以命令行方式启动和关闭MySQL服务器的操作，不涉及复杂的启动参数设置和安全设置。MySQL服务器按照默认的方式安装在本机Mac下，当前用户需要拥有管理员权限。</p>
<p>MySQL的默认安装路径为<code>/usr/local/mysql</code>,以<code>shell</code>代替通用命令解释程序，即终端提示符，记录如下:</p>
<h3 id="启动MySQL服务器"><a href="#启动MySQL服务器" class="headerlink" title="启动MySQL服务器"></a>启动MySQL服务器</h3><ol>
<li><p>使用<strong>mysqld_safe服务器启动脚本</strong></p>
<pre><code><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">shell&gt; <span class="built_in">cd</span> /usr/<span class="built_in">local</span>/mysql/bin</div><div class="line">shell&gt; sudo ./mysqld_safe</div></pre></td></tr></table></figure>
</code></pre><p> 启动成功提示，如下：</p>
<pre><code><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">140112 15:26:33 mysqld_safe Logging to <span class="string">'/usr/local/mysql/data/192.168.2.111.err'</span>.</div><div class="line">140112 15:26:33 mysqld_safe Starting mysqld daemon with databases from /usr/<span class="built_in">local</span>/mysql/data</div></pre></td></tr></table></figure>
</code></pre><p> 按<code>Ctrl-Z</code>快捷键，退出会话，提示如下</p>
<pre><code>^Z
[5]+  Stopped                 sudo ./mysqld_safe
shell&gt;
</code></pre></li>
<li><p>直接启动<strong>mysqld服务器</strong></p>
<pre><code><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">shell&gt; <span class="built_in">cd</span> /usr/<span class="built_in">local</span>/mysql/bin</div><div class="line">shell&gt; sudo ./mysqld -u root</div></pre></td></tr></table></figure>
</code></pre><p> 成功启动后的log输出，如下</p>
<pre><code><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">2014-01-12 16:18:55 0 [Warning] TIMESTAMP with implicit DEFAULT value is deprecated. Please use --explicit_defaults_for_timestamp server option (see documentation <span class="keyword">for</span> more details).</div><div class="line">2014-01-12 16:18:55 42936 [Warning] Setting lower_case_table_names=2 because file system <span class="keyword">for</span> /usr/<span class="built_in">local</span>/mysql-5.6.15-osx10.7-x86_64/data/ is <span class="keyword">case</span> insensitive</div><div class="line">2014-01-12 16:18:55 42936 [Note] Plugin <span class="string">'FEDERATED'</span> is disabled.</div><div class="line">2014-01-12 16:18:55 42936 [Note] InnoDB: The InnoDB memory heap is disabled</div><div class="line">2014-01-12 16:18:55 42936 [Note] InnoDB: Mutexes and rw_locks use GCC atomic builtins</div><div class="line">2014-01-12 16:18:55 42936 [Note] InnoDB: Compressed tables use zlib 1.2.3</div><div class="line">2014-01-12 16:18:55 42936 [Note] InnoDB: Using CPU crc32 instructions</div><div class="line">2014-01-12 16:18:55 42936 [Note] InnoDB: Initializing buffer pool, size = 128.0M</div><div class="line">2014-01-12 16:18:55 42936 [Note] InnoDB: Completed initialization of buffer pool</div><div class="line">2014-01-12 16:18:55 42936 [Note] InnoDB: Highest supported file format is Barracuda.</div><div class="line">2014-01-12 16:18:55 42936 [Note] InnoDB: 128 rollback segment(s) are active.</div><div class="line">2014-01-12 16:18:55 42936 [Note] InnoDB: Waiting <span class="keyword">for</span> purge to start</div><div class="line">2014-01-12 16:18:56 42936 [Note] InnoDB: 5.6.15 started; <span class="built_in">log</span> sequence number 1645361</div><div class="line">2014-01-12 16:18:56 42936 [Note] Server hostname (<span class="built_in">bind</span>-address): <span class="string">'*'</span>; port: 3306</div><div class="line">2014-01-12 16:18:56 42936 [Note] IPv6 is available.</div><div class="line">2014-01-12 16:18:56 42936 [Note]   - <span class="string">'::'</span> resolves to <span class="string">'::'</span>;</div><div class="line">2014-01-12 16:18:56 42936 [Note] Server socket created on IP: <span class="string">'::'</span>.</div><div class="line">2014-01-12 16:18:56 42936 [Note] Event Scheduler: Loaded 0 events</div><div class="line">2014-01-12 16:18:56 42936 [Note] ./mysqld: ready <span class="keyword">for</span> connections.</div><div class="line">Version: <span class="string">'5.6.15'</span>  socket: <span class="string">'/tmp/mysql.sock'</span>  port: 3306  MySQL Community Server (GPL)</div></pre></td></tr></table></figure>
</code></pre><p> 按<code>Ctrl-Z</code>快捷键，退出会话，提示如下</p>
<pre><code><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">^Z</div><div class="line">[1]+  Stopped                 sudo ./mysqld -u root</div><div class="line">shell&gt;</div></pre></td></tr></table></figure>
</code></pre><blockquote>
<p><code>-u</code>选项，指定启动<strong>mysql服务器</strong>的操作系统的登录账户名称或账户ID，而不是MySQL授权表中所列出的用户</p>
</blockquote>
</li>
<li><p>调用<strong>mysql.server</strong>脚本启动MySQL服务器</p>
<p> Unix中的MySQL的分发版中包含了<strong>mysql.server</strong>脚本，可用于使用<code>System V-style</code>运行目录来启动和停止系统服务器的系统，可以用于MySQL的Mac OS X Startup Item。
Unix下<strong>mysql.server</strong>位于MySQL安装目录的下的<code>support-files</code>目录中，命令如下</p>
<pre><code><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">shell&gt; <span class="built_in">cd</span> /usr/<span class="built_in">local</span>/mysql/support-files/</div><div class="line">shell&gt; sudo ./mysql.server start</div><div class="line">Starting MySQL</div><div class="line">. SUCCESS!</div><div class="line">shell&gt;</div></pre></td></tr></table></figure>
</code></pre></li>
</ol>
<h3 id="关闭MySQL服务器"><a href="#关闭MySQL服务器" class="headerlink" title="关闭MySQL服务器"></a>关闭MySQL服务器</h3><ol>
<li><p>使用<strong>mysqladmin管理工具</strong>关闭mysql服务器</p>
<p> 涉及以下几个选项</p>
<ul>
<li><code>--host=host_name</code>或<code>-h host_name</code> 连接指定主机上的MySQL服务器，unix下默认为localhost。</li>
<li><code>--user=user_name</code>或<code>-u user_name</code> 使用指定账户连接MySQL服务器，unix默认为用户的登陆账户名。</li>
<li><code>--password[=password]</code>或<code>-p[password]</code>,指定连接MySQL服务器使用账户的密码，短选项<code>-p</code>与密码之间<strong>不能有</strong>空格，默认为空。</li>
<li><p><code>--port=port_num</code>或<code>-P port_num</code>，用于连接MySQL服务器的TCP/IP端口号，默认为3306。</p>
<p>以上在<strong>mysqladmin</strong>中为使用的选项，都使用其默认值。使用<code>shutdown</code>明亮关闭本机运行的MySQL服务器,如下</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">shell&gt; <span class="built_in">cd</span> /usr/<span class="built_in">local</span>/bin/mysql</div><div class="line">shell&gt; sudo ./mysqladmin -u root -p shutdown</div><div class="line">Password:******</div><div class="line">Enter password:******</div><div class="line">shell&gt;</div></pre></td></tr></table></figure>
<p>假设<strong>mysqladmin</strong>安装在你本机，而你需要关闭的MySQL服务器运行在IP地址为<code>118.224.203.236</code>的主机上，监听端口为<code>3001</code>，账户名为<code>root</code>,密码为<code>123456</code>命令如下</p>
 <figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">shell&gt; mysqladmin -h 118.224.203.236 -u root -p123456 -P 3001 shutdown</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>调用<strong>mysql.server</strong>脚本关闭MySQL服务器</p>
<pre><code><figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">shell&gt; <span class="built_in">cd</span> /usr/<span class="built_in">local</span>/mysql/support-files/</div><div class="line">shell&gt; sudo ./mysql.server stop</div><div class="line">Shutting down MySQL</div><div class="line">. SUCCESS!</div><div class="line">shell&gt;</div></pre></td></tr></table></figure>
</code></pre></li>
</ol>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="http://dev.mysql.com/doc/refman/5.1/zh/database-administration.html#server-options" target="_blank" rel="external">mysqld命令行选项,5.1版</a></li>
<li><a href="http://dev.mysql.com/doc/refman/5.6/en/server-options.html#option_mysqld_user" target="_blank" rel="external">mysqld<code>--user</code>命令行选项,5.6版</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://monjer.github.io/2014/01/20/Mac-OS-X下卸载MySQL/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="monjer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="monjer's note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2014/01/20/Mac-OS-X下卸载MySQL/" itemprop="url">Mac OS X下卸载MySQL</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-01-20T00:00:00+08:00">
                2014-01-20
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2014/01/20/Mac-OS-X下卸载MySQL/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2014/01/20/Mac-OS-X下卸载MySQL/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Mac OS X下可以使用MySQL pkg安装文件安装MySQL，但该安装包并没有提供卸载MySQL的功能，如果要卸载已经安装的MySQL，需要使用命令或者直接查看目录的形式来手工删除MySQL的安装目录和文件。<strong>在卸载MySQL之前确保系统已经停止MySQL服务的运行。</strong>以下以MySQL的默认安装目录来说明其卸载过程。</p>
<h3 id="查看MySQL的安装目录，手工删除MySQL的目录文件"><a href="#查看MySQL的安装目录，手工删除MySQL的目录文件" class="headerlink" title="查看MySQL的安装目录，手工删除MySQL的目录文件"></a>查看MySQL的安装目录，手工删除MySQL的目录文件</h3><ul>
<li><p>删除MySQL的安装主目录</p>
<p>  在Finder中进入MySQL的默认安装路径<code>/usr/local/mysql</code>,删除MySQL的主目录(mysql-VERSION)和链接(mysql)</p>
  <img src="/2014/01/20/Mac-OS-X下卸载MySQL/1.png" alt="1.png" title="">
</li>
<li><p>删除MySQL Startup Item以及相关配置文件（可选，如果已经<a href="http://dev.mysql.com/doc/refman/5.6/en/macosx-installation-startupitem.html" target="_blank" rel="external">安装</a>）</p>
<p>  在Finder中进入<code>/Library/StartupItems/MySQLCOM</code>,删除<code>MySQLCOM</code>目录。</p>
  <img src="/2014/01/20/Mac-OS-X下卸载MySQL/2.png" alt="2.png" title="">
<p>  在Finder中进入<code>/etc</code>目录，查找<code>hostconfig</code>文件，用<code>vim</code>或其它文本编辑器打开，删除配置项中的<code>MYSQLCOM=-YES-</code>一项。</p>
  <img src="/2014/01/20/Mac-OS-X下卸载MySQL/3.png" alt="3.png" title="">
</li>
<li><p>删除MySQL prefPane(可选，如果已经<a href="http://dev.mysql.com/doc/refman/5.6/en/macosx-installation-prefpane.html" target="_blank" rel="external">安装</a>)</p>
<p>  在Finder中进入<code>/Library/PreferencePanes</code>,查找<code>MySQL.prefPane</code>文件，并删除</p>
  <img src="/2014/01/20/Mac-OS-X下卸载MySQL/4.png" alt="4.png" title="">
</li>
<li><p>删除Receipts相关文件</p>
<p>  在Finder中进入<code>/Library/Receipts</code>,将对应的mysql-VERSION对应的<code>Package Recepit</code>目录删除</p>
  <img src="/2014/01/20/Mac-OS-X下卸载MySQL/5.png" alt="5.png" title="">
<p>  在Finder中进入<code>/var/db/receipts</code>,将以<code>com.mysql</code>开头的文件删除</p>
  <img src="/2014/01/20/Mac-OS-X下卸载MySQL/6.png" alt="6.png" title="">
</li>
</ul>
<h3 id="以命令方式，卸载MySQL"><a href="#以命令方式，卸载MySQL" class="headerlink" title="以命令方式，卸载MySQL"></a>以命令方式，卸载MySQL</h3><ul>
<li><p>删除主目录</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">shell&gt;sudo rm /usr/<span class="built_in">local</span>/mysql</div><div class="line">shell&gt;sudo rm -rf /usr/<span class="built_in">local</span>/mysql*</div></pre></td></tr></table></figure>
</li>
<li><p>删除MySQL Startup Item及<code>hostconfig</code>配置项<code>MYSQLCOM=-YES-</code></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">shell&gt;sudo rm -rf /Library/StartupItems/MySQLCOM</div><div class="line">shell&gt;sudo rm -rf /Library/PreferencePanes/My</div><div class="line">shell&gt;vim /etc/hostconfig</div></pre></td></tr></table></figure>
</li>
<li><p>删除MySQL prefPane</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">shell&gt;rm -rf ~/Library/PreferencePanes/My*</div></pre></td></tr></table></figure>
</li>
<li><p>删除Receipts</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">shell&gt;sudo rm -rf /Library/Receipts/mysql*</div><div class="line">shell&gt;sudo rm -rf /Library/Receipts/MySQL*</div><div class="line">shell&gt;sudo rm -rf /var/db/receipts/com.mysql.*</div></pre></td></tr></table></figure>
</li>
</ul>
<blockquote>
<p>对已有的MySQL进行升级，新的MySQL pkg安装包不会卸载旧的安装目录，Mac OS X的安装包未提供合适的功能来正确升级之前旧的已经安装的软件包。</p>
<p>在新安装的MySQL中使用已有的数据库，需要将旧数据目录(<code>/usr/local/mysql/data</code>)中的内容复制到新的数据目录中。执行
该操作时确保关闭新、旧服务器。将以前安装的MySQL数据库文件复制过来并成功重启服务器后，应当卸载旧的文件以节省磁盘空
间。并且还要卸载掉在/Library/Receipts/mysql-VERSION.pkg的旧版本的Package Receipt</p>
</blockquote>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="http://dev.mysql.com/doc/refman/5.1/zh/installing.html#mac-os-x-installation" target="_blank" rel="external">在Mac OS X中安装MySQL</a></li>
<li><a href="http://dev.mysql.com/doc/refman/5.6/en/macosx-installation-pkg.html" target="_blank" rel="external">Installing MySQL on Mac OS X Using Native Packages</a></li>
<li><a href="http://stackoverflow.com/questions/1436425/how-do-you-uninstall-mysql-from-mac-os-x" target="_blank" rel="external">How do you uninstall MySQL from Mac OS X?</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://monjer.github.io/2013/12/20/javascript对象类型判断/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="monjer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="monjer's note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/12/20/javascript对象类型判断/" itemprop="url">JavaScript对象类型判断</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2013-12-20T00:00:00+08:00">
                2013-12-20
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2013/12/20/javascript对象类型判断/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2013/12/20/javascript对象类型判断/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="使用typeof操作符"><a href="#使用typeof操作符" class="headerlink" title="使用typeof操作符"></a>使用typeof操作符</h3><p>typeof操作符号的作用是返回一个用于只是其操作对象类型的字符串。语法如下：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typeof</span> val</div></pre></td></tr></table></figure>
<p><code>val</code>参数作为一个表达式，代表了JavaScript中的对象类型或基本数据类型，<code>typeof</code>运算会返回该对象或基本数据类型的字符串描述。</p>
<p><code>typeof</code>根据操作对象和对应的类型描述字符串，包括以下几种：</p>
 <table class="standard-table">
         <thead>
  <tr>
   <th scope="col">操作对象或基本数据类型</th>
   <th scope="col">类型描述字符串</th>
  </tr>
 </thead>
 <tbody>
  <tr>
   <td>Undefined</td>
   <td><code>“undefined”</code></td>
  </tr>
  <tr>
   <td>Null</td>
   <td><code>“object”</code></td>
  </tr>
  <tr>
   <td>Boolean</td>
   <td><code>“boolean”</code></td>
  </tr>
  <tr>
   <td>Number</td>
   <td><code>“number”</code></td>
  </tr>
  <tr>
   <td>String</td>
   <td><code>“string”</code></td>
  </tr>
  <tr>
   <td>Function</td>
   <td><code>“function”</code></td>
  </tr>
  <tr>
   <td>Object(任何其它js对象)</td>
   <td><code>“object”</code></td>
  </tr>
 </tbody>
</table>


<p>例如:
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// string</span></div><div class="line"><span class="keyword">typeof</span> <span class="string">""</span> === <span class="string">"string"</span>;</div><div class="line"><span class="keyword">typeof</span> <span class="string">"abc"</span> === <span class="string">"string"</span> ;</div><div class="line"><span class="keyword">typeof</span> <span class="built_in">String</span>(<span class="string">"abc"</span>) === <span class="string">"string"</span> ;</div><div class="line"><span class="keyword">typeof</span> (<span class="keyword">typeof</span> <span class="number">1</span>) === <span class="string">"string"</span> ;</div><div class="line"></div><div class="line"><span class="comment">// number</span></div><div class="line"><span class="keyword">typeof</span> <span class="number">1</span> === <span class="string">"number"</span> ;</div><div class="line"><span class="keyword">typeof</span> <span class="literal">NaN</span> === <span class="string">"number"</span> ;</div><div class="line"><span class="keyword">typeof</span> <span class="built_in">Math</span>.PI === <span class="string">"number"</span> ;</div><div class="line"><span class="keyword">typeof</span> <span class="literal">Infinity</span> === <span class="string">"number"</span> ;</div><div class="line"><span class="keyword">typeof</span> <span class="built_in">Number</span>(<span class="number">1</span>) === <span class="string">"number"</span>;</div><div class="line"></div><div class="line"><span class="comment">// boolean</span></div><div class="line"><span class="keyword">typeof</span> <span class="literal">true</span> === <span class="string">"boolean"</span> ;</div><div class="line"><span class="keyword">typeof</span> <span class="literal">false</span> === <span class="string">"boolean"</span> ;</div><div class="line"><span class="keyword">typeof</span> <span class="built_in">Boolean</span>(<span class="literal">false</span>) === <span class="string">"boolean"</span>;</div><div class="line"></div><div class="line"><span class="comment">// undefined</span></div><div class="line"><span class="keyword">typeof</span> Undefined === <span class="string">"undefined"</span> ;</div><div class="line"><span class="keyword">typeof</span> val === <span class="string">"undefined"</span>; <span class="comment">// 在js中通过var定义但未初始化的变量值为undefined,任何未通过var定义且未初始化的变量的初值为undefined</span></div><div class="line"></div><div class="line"><span class="comment">// function</span></div><div class="line"><span class="keyword">typeof</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125; === <span class="string">"function"</span> ; </div><div class="line"><span class="keyword">typeof</span> <span class="built_in">String</span> === <span class="string">"function"</span> ;</div><div class="line"><span class="keyword">typeof</span> <span class="built_in">Object</span> === <span class="string">"function"</span> ;</div><div class="line"><span class="keyword">typeof</span> <span class="keyword">new</span> <span class="built_in">Function</span>() === <span class="string">"function"</span> ;</div><div class="line"></div><div class="line"><span class="comment">// object</span></div><div class="line"><span class="keyword">typeof</span> &#123;&#125; === <span class="string">"object"</span> ;</div><div class="line"><span class="keyword">typeof</span> [] === <span class="string">"object"</span> ;</div><div class="line"><span class="keyword">typeof</span> <span class="keyword">new</span> <span class="built_in">Date</span>() === <span class="string">"object"</span> ;</div><div class="line"><span class="keyword">typeof</span> <span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">"abc"</span>) === <span class="string">"object"</span> ; <span class="comment">// ---1</span></div><div class="line"><span class="keyword">typeof</span> <span class="keyword">new</span> <span class="built_in">Number</span>(<span class="string">"abc"</span>) === <span class="string">"object"</span> ; <span class="comment">// ---2</span></div><div class="line"><span class="keyword">typeof</span> <span class="keyword">new</span> <span class="built_in">Boolean</span>(<span class="string">"abc"</span>) === <span class="string">"object"</span> ;<span class="comment">// ---3</span></div><div class="line"><span class="keyword">typeof</span> <span class="literal">null</span> === <span class="string">"object"</span> ;				<span class="comment">// ---4</span></div></pre></td></tr></table></figure></p>
<p>以上示例中，在判断对象类型时1,2,3,4四种情况比较特殊，其中1,2,3属于一类，JavaScript中通过<code>new</code>操作符来创建对象，<code>new</code>后面跟的是构造器(constructor)，JavaScript中没有类似于java中的<code>自动装箱/拆箱(Auto-Boxing/Unboxing)</code>机制来完成基本数据类型与其对应对象类型的自动转换，语言的灵活性与语法的规范性不能兼得，所以在实际编程中只能靠约定尽量避免这种会产生歧义的使用方式。</p>
<p>null值在逻辑上表示空对象指针，这也可以理解<code>typeof</code>返回的返回值为什么是<code>&quot;object&quot;</code>了。所以非空对象类型的正确的判断方式是
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typeof</span> val === <span class="string">"object"</span> &amp;&amp; val !== <span class="literal">null</span></div></pre></td></tr></table></figure></p>
<p>此外以上判断对象类型的示例中忽略了JavaScript中的正则表达式。由于浏览器之间的差异，对于正则表达式的判断没有一致性的实现，对于正则表达式而言，<code>typeof</code>可能会返回<code>&quot;object&quot;</code>或<code>&quot;function&quot;</code>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typeof</span> /w/ === <span class="string">'function'</span> ;</div><div class="line"><span class="keyword">typeof</span> /w/ === <span class="string">'object'</span></div></pre></td></tr></table></figure></p>
<h3 id="使用toString方法"><a href="#使用toString方法" class="headerlink" title="使用toString方法"></a>使用toString方法</h3><p>JavaScript语言环境中提供了一些标准的内建对象类型，其中<code>Object</code>类型是所有对象类型的基类，JavaScript中没有纯粹化的<code>类型</code>的概念，而是基于JavaScript中特有的继承模式:<code>原型链继承</code>，所有内建类型对象或自定义类型对象在创建后都会继承<code>Object.prototype</code>中的属性和方法，在Object的原型对象中的<code>toString()</code>方法会返回一个代表对象类型的字符串，该字符串的格式为<code>&quot;[object type]&quot;</code>,其中<code>type</code>则代表对象的类型。如:
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> obj = <span class="keyword">new</span> <span class="built_in">Object</span>();</div><div class="line">obj.toString(); <span class="comment">// return [object Object]</span></div></pre></td></tr></table></figure></p>
<p>Ecmascript5.1版本的规范中对于Object.prototype.toString的描述如下</p>
<blockquote>
<p>15.2.4.2 Object.prototype.toString ( )</p>
<p>   When the toString method is called, the following steps are taken:</p>
<ol>
<li><p>If the this value is undefined, return “[object Undefined]”.</p>
</li>
<li><p>If the this value is null, return “[object Null]”.</p>
</li>
<li><p>Let O be the result of calling ToObject passing the this value as the argument.</p>
<ol>
<li><p>Let class be the value of the [[Class]] internal property of O.</p>
</li>
<li><p>Return the String value that is the result of concatenating the three Strings “[object “, &gt;class, and “]”.</p>
</li>
</ol>
</li>
</ol>
</blockquote>
<p>因此只要自定义类型没有重写其原型对象中的<code>toString()</code>方法，或着派生自<code>Object</code>的对象没有重写<code>toString()</code>方法，那么调用对象本身的<code>toString()</code>方法可以正确获得其类型描述。如对于内建类型:
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// date</span></div><div class="line"><span class="keyword">new</span> <span class="built_in">Date</span>().toString(); <span class="comment">// return [object Date]</span></div><div class="line"></div><div class="line"><span class="comment">// number</span></div><div class="line"><span class="keyword">var</span> val = <span class="number">1</span> ;</div><div class="line"><span class="keyword">new</span> <span class="built_in">Number</span>(<span class="number">1</span>).toString();	<span class="comment">// return [object Number]</span></div><div class="line">val.toString(); <span class="comment">// return [object Number]</span></div><div class="line"></div><div class="line"><span class="comment">// boolean</span></div><div class="line"><span class="keyword">new</span> <span class="built_in">Boolean</span>(<span class="literal">true</span>).toString(); <span class="comment">// return [object Boolean]</span></div><div class="line"><span class="keyword">var</span> val = <span class="literal">true</span> ;</div><div class="line">val.toString(); <span class="comment">// return [object Boolean]</span></div><div class="line"></div><div class="line"><span class="comment">// string</span></div><div class="line"><span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">""</span>).toString();<span class="comment">// return [object String]</span></div><div class="line"><span class="keyword">var</span> val = “” ;</div><div class="line">val.toString(); <span class="comment">// return [object String]</span></div><div class="line"></div><div class="line"><span class="comment">// object</span></div><div class="line"><span class="keyword">new</span> <span class="built_in">Object</span>().toString();<span class="comment">// return [object Object]</span></div><div class="line"></div><div class="line"><span class="comment">// regexp</span></div><div class="line"><span class="keyword">new</span> Regexp().toString();<span class="comment">// return [object Regexp]</span></div><div class="line"><span class="keyword">var</span> val = <span class="regexp">/w/</span> ;</div><div class="line">val.toString();<span class="comment">// return [object Regexp]</span></div><div class="line"></div><div class="line"><span class="comment">// array</span></div><div class="line"><span class="keyword">new</span> <span class="built_in">Array</span>().toString();<span class="comment">// return [object Array]</span></div><div class="line"><span class="keyword">var</span> val = [];</div><div class="line">val.toString();<span class="comment">// return [object Array]</span></div><div class="line"></div><div class="line"><span class="comment">// function</span></div><div class="line"><span class="keyword">new</span> <span class="built_in">Function</span>().toString();<span class="comment">// return [object Function]</span></div><div class="line"><span class="keyword">var</span> val = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;</div><div class="line">val.toString();<span class="comment">// return [object Function]</span></div><div class="line"></div><div class="line"><span class="comment">// error</span></div><div class="line"><span class="keyword">new</span> <span class="built_in">Error</span>().toString();<span class="comment">// return [object Error]</span></div></pre></td></tr></table></figure></p>
<p>对于自定义类型:
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name</span>)</span>&#123;</div><div class="line">	<span class="keyword">this</span>.name = name ;</div><div class="line">&#125;</div><div class="line"><span class="keyword">new</span> Person().toString();<span class="comment">// return [object Object]</span></div></pre></td></tr></table></figure></p>
<p>如果自定义类型覆盖<code>toString</code>方法，如:
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Person.prototype.toString = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">	<span class="keyword">return</span> <span class="string">"Person Class"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>那么，之后
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> Person().toString() <span class="comment">// return Person Class</span></div></pre></td></tr></table></figure></p>
<p>因此要在所有对象上都能使用原始的<code>Object.ptototype.toString</code>方法，需要结合<code>Function.prototype.call</code>方法，并将对象作为<code>this</code>参数传递进<code>call</code>方法，如:
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> _toString = <span class="built_in">Object</span>.prototype.toString;</div><div class="line"></div><div class="line">_toString.call(<span class="keyword">new</span> Person());<span class="comment">// return [object Object]</span></div></pre></td></tr></table></figure></p>
<p>这样相对于<code>typeof</code>来说，使用<code>toString</code>方法来判断不但能区分变量是否是对象类型，甚至可以判断对象的是数组，日期，正则表达式,还是函数。</p>
<h3 id="jQuery-type-的实现"><a href="#jQuery-type-的实现" class="headerlink" title="jQuery.type()的实现"></a>jQuery.type()的实现</h3><p>jQuery中提供了一个用来判断对象<code>内建</code>类型的方法<a href="http://api.jquery.com/jQuery.type/" target="_blank" rel="external"><code>jQuery.type</code></a>,其内部实现则是结合<code>typeof</code>和<code>toString</code>方法实现的。实现流程其源码如下:</p>
<ol>
<li><p>定义保存类型的全称与简写映射的对象</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// [[Class]] -&gt; type pairs</span></div><div class="line">class2type = &#123;&#125;,</div></pre></td></tr></table></figure>
</li>
<li><p>定义保存<code>Object.prototype.toString</code>方法的变量,此处使用的是原型继承来实现</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">core_toString = class2type.toString,</div></pre></td></tr></table></figure>
</li>
<li><p>建立实际的映射关系,<code>[object type] -- &gt; type</code></p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Populate the class2type map</span></div><div class="line">jQuery.each(<span class="string">"Boolean Number String Function Array Date RegExp Object 		Error"</span>.split(<span class="string">" "</span>), <span class="function"><span class="keyword">function</span>(<span class="params">i, name</span>) </span>&#123;</div><div class="line">	class2type[ <span class="string">"[object "</span> + name + <span class="string">"]"</span> ] = name.toLowerCase();</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>实现<a href="http://api.jquery.com/jQuery.type/" target="_blank" rel="external"><code>jQuery.type</code></a>方法，并扩展到jQuery中，以下是简化版</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">jQuery.extend(&#123;</div><div class="line">	<span class="attr">type</span>: <span class="function"><span class="keyword">function</span>(<span class="params"> obj </span>) </span>&#123;</div><div class="line">		<span class="keyword">if</span> ( obj == <span class="literal">null</span> ) &#123;</div><div class="line">			<span class="keyword">return</span> <span class="built_in">String</span>( obj );</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">typeof</span> obj === <span class="string">"object"</span> || <span class="keyword">typeof</span> obj === <span class="string">"function"</span> ?</div><div class="line">		class2type[ core_toString.call(obj) ] || <span class="string">"object"</span> :</div><div class="line">		<span class="keyword">typeof</span> obj;</div><div class="line">	&#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ol>
<p><a href="http://api.jquery.com/jQuery.type/" target="_blank" rel="external"><code>jQuery.type</code></a>方法调用返回的是字符串类型，所有返回值包括<code>&#39;object&#39;</code>,<code>&#39;null&#39;</code>,<code>&#39;undefined&#39;</code>,<code>&#39;date&#39;</code>,<code>&#39;number&#39;</code>,<code>&#39;function&#39;</code>,<code>&#39;array&#39;</code>,<code>&#39;string&#39;</code>,<code>&#39;regexp&#39;</code>,<code>&#39;boolean&#39;</code></p>
<blockquote>
<p>JavaScript中 null == undefined会返回true</p>
</blockquote>
<p>具体实例，参见<a href="http://api.jquery.com/jQuery.type/" target="_blank" rel="external"><code>jQuery.type</code></a>官网API</p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/toString" target="_blank" rel="external">MDN toString()</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/typeof" target="_blank" rel="external">MDN typeof</a></li>
<li><a href="http://api.jquery.com/jQuery.type/" target="_blank" rel="external">jQuery.type()</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://monjer.github.io/2013/11/27/mysql随机选取数据/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="monjer">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="monjer's note">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2013/11/27/mysql随机选取数据/" itemprop="url">mysql随机选取数据</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2013-11-27T00:00:00+08:00">
                2013-11-27
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2013/11/27/mysql随机选取数据/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2013/11/27/mysql随机选取数据/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>开发场景中有一种需求是：随机筛选(或同时在满足某个<code>where</code>查询条件的情况下)一个表中的N条记录项。MySQL中使用<code>rand()</code>函数,<code>order by</code>语句,<code>limit</code>语句结合来实现该功能，如下：</p>
<pre><code class="sql">// 从表中随机筛选出10条记录项
<span class="keyword">select</span> * <span class="keyword">from</span> <span class="keyword">Table</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">rand</span>() <span class="keyword">limit</span> <span class="number">10</span>

// 在满足<span class="keyword">where</span>语句指定的条件下，随机筛选出<span class="number">10</span>条记录
<span class="keyword">select</span> * <span class="keyword">table</span> <span class="keyword">where</span> <span class="keyword">id</span> &gt; <span class="number">100</span> <span class="keyword">order</span> <span class="keyword">by</span> <span class="keyword">rand</span>() <span class="keyword">limit</span> <span class="number">10</span>
</code></pre>
<p>MySQL中<code>rand()</code>和<code>rand(n)</code>函数用来生成以及随机的浮点值y，满足<code>0&lt;= y &lt;=1.0</code>,指定的整型值n用来作为随机序列的种子，用来产生重复值。
以下来自mysql手册中对于<code>rand()</code>函数的一种用法的示例:
&gt;</p>
<blockquote>
<p>若要在<code>i ≤ R ≤ j</code> 这个范围得到一个随机整数R ，需要用到表达式 <code>FLOOR(i + RAND() * &gt;(j – i + 1))</code>。
例如，若要在7 到 12 的范围（包括7和12）内得到一个随机整数, 可使用以下语句：
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">SELECT</span> <span class="keyword">FLOOR</span>(<span class="number">7</span> + (<span class="keyword">RAND</span>() * <span class="number">6</span>)); </div></pre></td></tr></table></figure></p>
</blockquote>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/12/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><span class="page-number current">13</span><a class="page-number" href="/page/14/">14</a><a class="extend next" rel="next" href="/page/14/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="monjer" />
          <p class="site-author-name" itemprop="name">monjer</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">136</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">84</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">monjer</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"monjer"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  
















  





  

  

  

  

  

</body>
</html>
